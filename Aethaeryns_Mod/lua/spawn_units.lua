#define MOD_LUA_SPAWN_UNITS
<<
spawn_unit = {}

-- Chooses the adjacent summoner with the highest HP.
local function find_summoner(x, y, summoners)
   local max_hp = 0
   for key,value in pairs(summoners) do
      if summoners[key].x <= x + 1 and summoners[key].x >= x - 1
         and summoners[key].y <= y + 1 and summoners[key].y >= y - 1
         and summoners[key].hitpoints > max_hp then
         max_hp  = summoners[key].hitpoints
         max_key = key
      end
   end
   return summoners[max_key]
end

function haste(x, y, moves)
   wesnoth.add_modification(wesnoth.get_unit(x, y),
                            "object",
                            { duration = "turn",
                              T.effect { apply_to = "movement", increase = moves },
                              T.effect { apply_to = "attack", increase_attacks = 1 },
                              T.effect { apply_to = "new_ability",
                                         T.abilities { T.dummy { name = _ "haste",
                                                                 description = _ "This unit has extra attacks and movement." } } } })
end

-- Unit role is summoner type; icon and unit_role are optional.
function spawn_unit.spawn_unit(x, y, unit_type, side_number, icon, unit_role, gender)
   local unit_stats = {type = unit_type,
                       side = side_number,
                       upkeep = 0}
   if string.find(wesnoth.get_terrain(x, y), "%^V") ~= nil then
      fire.capture_village(x, y, side_number)
      unit_stats.moves = 0
   end
   if icon ~= nil then
      unit_stats.overlays = icon
   end
   if unit_role ~= nil then
      unit_stats.role = unit_role
   end
   if gender ~= nil then
      unit_stats.gender = gender
   end
   wesnoth.put_unit(x, y, unit_stats)
end

function spawn_unit.spawn_group(x, y, units, side_number)
   local hexes = wesnoth.get_locations { x = x, y = y, radius = 1 }
   local j = 1
   for i, unit in ipairs(units) do
      if wesnoth.get_unit(hexes[j][1], hexes[j][2]) == nil then
         spawn_unit.spawn_unit(hexes[j][1], hexes[j][2], unit, side_number)
      end
      j = j + 1
   end
end

function spawn_unit.boss_spawner(x, y, unit_type, unit_role, side_number)
   spawn_unit.spawn_unit(x, y, unit_type, side_number, "misc/hero-icon.png", unit_role)
   local regenerates = wesnoth.get_variable("regenerates")
   local boss_ability = { T["effect"] { apply_to = "new_ability", {"abilities", regenerates}}}
   local unit = wesnoth.get_unit(x, y)
   wesnoth.add_modification(unit, "object", boss_ability)
end

function spawn_unit.reg_spawner(x, y, unit_type, unit_role, side_number)
   local unit_cost = wesnoth.unit_types[unit_type].__cfg.cost
   local summoner = find_summoner(x, y, wesnoth.get_units {side = side_number, role = unit_role})
   if summoner.hitpoints > unit_cost then
      summoner.hitpoints = summoner.hitpoints - unit_cost
      spawn_unit.spawn_unit(x, y, unit_type, side_number)
      return true
   else
      return false
   end
end

-- Spawns all the preset units so the huge maps can get populated.
local function spawn_npc(coord, unit_name)
   spawn_unit.spawn_unit(coord[1], coord[2], unit_name, 6)
end

function spawn_default_starting_units()
   if wesnoth.get_variable("aeth_scenario_name") == "Woods" then
      local peasant_coords = {
         {70, 129},
         {65, 128},
         {58, 125},
         {61, 122},
         {69, 123},
         {73, 124},
         {82, 117},
         {75, 114},
         {71, 116},
         {62, 114},
         {64, 111},
         {61, 109},
         {66, 106},
         {77, 107},
         {83, 111},
         {56, 103},
         {59, 99},
         {57, 96},
         {49, 85},
         {55, 83},
         {51, 81},
         {56, 77},
         {59, 80},
         {63, 75},
         {56, 69},
         {70, 73},
         {72, 78},
         {78, 75},
         {79, 67},
         {86, 66},
         {86, 71},
         {88, 74},
         {93, 67},
         {92, 73},
         {87, 82},
         {91, 83},
         {89, 86},
         {98, 88},
         {104, 89},
         {102, 92},
         {100, 62},
         {104, 62},
         {110, 64},
         {112, 67},
         {108, 74},
         {139, 52},
         {141, 52},
         {141, 48},
         {150, 49},
         {152, 55},
         {155, 55},
         {151, 46},
         {153, 44},
         {158, 46},
         {162, 44},
         {166, 36},
         {178, 37},
         {171, 70},
         {170, 68},
         {173, 63},
         {178, 63},
         {189, 25},
         {195, 25},
         {196, 29},
         {196, 20},
         {26, 144},
         {23, 147},
         {30, 146},
         {44, 149},
         {35, 152},
         {37, 153},
         {31, 158},
         {35, 164},
         {30, 167},
         {35, 167},
         {40, 166},
         {41, 171},
         {54, 182},
         {57, 187},
         {58, 189},
         {57, 193},
         {92, 122},
         {100, 123},
         {87, 125},
         {96, 118},
         {94, 122},
         {64, 98},
         {71, 105},
         {63, 90},
         {60, 90},
         {65, 87},
         {87, 102},
      }
      local woodsman_coords = {
         {23, 44},
         {31, 72},
         {39, 91},
         {44, 94},
         {23, 124},
         {17, 131},
         {37, 42},
         {35, 48},
         {53, 50},
         {118, 69},
         {123, 70},
         {125, 65},
         {138, 81},
         {42, 196},
         {46, 197},
         {43, 137},
         {48, 140},
         {35, 130},
         {99, 117},
         {87, 123},
         {90, 132},
         {64, 95},
         {68, 83},
         {98, 97},
      }
      local ruffian_coords = {
         {133, 74},
         {135, 72},
         {140, 79},
         {142, 76},
         {115, 86},
         {117, 85},
         {107, 93},
         {107, 95},
         {64, 194},
         {62, 191},
         {65, 193},
         {50, 169},
         {53, 170},
         {66, 132},
         {69, 132},
         {102, 117},
         {89, 109},
         {88, 110},
         {101, 100},
         {102, 101},
         {101, 102},
         {99, 102},
         {96, 103},
         {94, 103},
         {91, 105},
      }
      local guard_coords = {
         -- Mountain spawns
         {37, 21, "Spearman"},
         {38, 15, "Spearman"},
         {53, 15, "Spearman"},
         {62, 14, "Spearman"},
         {65, 21, "Spearman"},
         {69, 33, "Poacher"},
         {86, 27, "Spearman"},
         {99, 28, "Bowman"},
         -- Northwest forest spawns
         {6, 54, "Spearman"},
         {8, 58, "Heavy Infantryman"},
         {7, 62, "Bowman"},
         {15, 55, "Bowman"},
         {17, 57, "Bowman"},
         {14, 64, "Bowman"},
         {18, 62, "Swordsman"},
         {35, 69, "Spearman"},
         {41, 75, "Heavy Infantryman"},
         {44, 73, "Longbowman"},
         {36, 77, "Bowman"},
         {47, 75, "Horseman"},
         {43, 78, "Horseman"},
         {52, 77, "Cavalryman"},
         {37, 36, "Bowman"},
         {34, 52, "Bowman"},
         {38, 59, "Bowman"},
         {39, 61, "Spearman"},
         {41, 63, "Spearman"},
         {53, 41, "Poacher"},
         {66, 45, "Poacher"},
         {64, 58, "Poacher"},
         {51, 65, "Bowman"},
         {54, 67, "Longbowman"},
         {57, 66, "Swordsman"},
         {53, 71, "Lieutenant"},
         {52, 68, "Spearman"},
         {51, 70, "Spearman"},
         {54, 72, "Bowman"},
         {55, 72, "Bowman"},
         {56, 72, "Spearman"},
         {59, 72, "Spearman"},
         {59, 67, "Bowman"},
         {61, 67, "Spearman"},
         {64, 68, "Spearman"},
         {69, 69, "Bowman"},
         {71, 68, "Spearman"},
         {57, 67, "Cavalryman"},
         {62, 76, "Spearman"},
         {41, 80, "Spearman"},
         {43, 81, "Bowman"},
         {43, 82, "Spearman"},
         {49, 84, "Bowman"},
         {51, 85, "Bowman"},
         {55, 86, "Cavalryman"},
         {73, 73, "Spearman"},
         {74, 75, "Heavy Infantryman"},
         {77, 72, "Heavy Infantryman"},
         {73, 76, "Cavalryman"},
         {75, 66, "Bowman"},
         {75, 65, "Spearman"},
         {78, 63, "Bowman"},
         {79, 63, "Bowman"},
         {80, 62, "Spearman"},
         {81, 64, "Lieutenant"},
         {85, 64, "Spearman"},
         {91, 66, "Sergeant"},
         {92, 64, "Bowman"},
         {93, 64, "Spearman"},
         {95, 62, "Spearman"},
         {99, 60, "Bowman"},
         {88, 72, "Bowman"},
         {93, 75, "Spearman"},
         {99, 67, "Lieutenant"},
         {98, 66, "Fencer"},
         {97, 67, "Knight"},
         {97, 68, "Horseman"},
         {98, 68, "Horseman"},
         {98, 67, "Longbowman"},
         {91, 70, "Cavalryman"},
         {106, 59, "Poacher"},
         {104, 67, "White Mage"},
         {106, 68, "Knight"},
         {106, 69, "Dragoon"},
         {107, 66, "Swordsman"},
         {107, 68, "Spearman"},
         {107, 70, "Bowman"},
         {104, 71, "Spearman"},
         {102, 71, "Spearman"},
         {100, 70, "Spearman"},
         {115, 64, "Pikeman"},
         {117, 66, "Swordsman"},
         {118, 64, "Horseman"},
         {121, 64, "Horseman"},
         {120, 65, "Spearman"},
         {121, 65, "Bowman"},
         {119, 63, "Spearman"},
         {122, 61, "Bowman"},
         {119, 66, "Horseman"},
         {123, 66, "Cavalryman"},
         {117, 71, "Cavalryman"},
         {133, 73, "Cavalryman"},
         {107, 76, "Shock Trooper"},
         {128, 62, "Spearman"},
         {128, 63, "Bowman"},
         {128, 66, "Spearman"},
         {128, 67, "Bowman"},
         {126, 68, "Lieutenant"},
         {127, 71, "Longbowman"},
         {139, 69, "Spearman"},
         {136, 70, "Bowman"},
         {134, 70, "Bowman"},
         {130, 72, "Spearman"},
         {130, 74, "Bowman"},
         {136, 81, "Bowman"},
         {139, 80, "Spearman"},
         {146, 76, "Spearman"},
         {147, 80, "Bowman"},
         {147, 79, "Thug"},
         {146, 74, "Lieutenant"},
         {145, 74, "Fencer"},
         {145, 75, "Knight"},
         {144, 77, "Horseman"},
         {146, 78, "Horseman"},
         {142, 80, "Horseman"},
         {139, 83, "Swordsman"},
         {144, 83, "Pikeman"},
         {142, 83, "Heavy Infantryman"},
         {146, 83, "Longbowman"},
         {147, 83, "Ranger"},
         {145, 83, "Swordsman"},
         {146, 82, "Heavy Infantryman"},
         {151, 74, "Spearman"},
         {106, 76, "Pikeman"},
         {107, 79, "Cavalryman"},
         {112, 80, "Lieutenant"},
         {111, 80, "Arch Mage"},
         {112, 81, "Swordsman"},
         {110, 80, "White Mage"},
         {111, 81, "Red Mage"},
         {111, 82, "Mage"},
         {112, 82, "Mage"},
         {112, 84, "Javelineer"},
         {116, 83, "Spearman"},
         {112, 86, "Bowman"},
         {113, 88, "Bowman"},
         {109, 87, "Shock Trooper"},
         {110, 88, "Duelist"},
         {110, 89, "Knight"},
         {108, 91, "Thug"},
         {109, 92, "Footpad"},
         {106, 92, "Rogue"},
         {105, 97, "General"},
         {106, 96, "Iron Mauler"},
         {106, 97, "Longbowman"},
         {103, 96, "White Mage"},
         {97, 93, "Halberdier"},
         {91, 90, "Halberdier"},
         {99, 90, "Dragoon"},
         {94, 87, "Spearman"},
         {94, 86, "Longbowman"},
         {92, 84, "Pikeman"},
         -- Southwest bandit camp
         {19, 192, "Highwayman"},
         {19, 194, "Rogue"},
         {21, 194, "Rogue"},
         {20, 193, "Rogue"},
         {19, 193, "Outlaw"},
         {21, 193, "Poacher"},
         {23, 192, "Footpad"},
         {24, 191, "Footpad"},
         {24, 190, "Poacher"},
         {23, 190, "Poacher"},
         {21, 190, "Thief"},
         {20, 190, "Thug"},
         {22, 184, "Bandit"},
         {22, 185, "Trapper"},
         {21, 186, "Footpad"},
         {20, 185, "Thief"},
         {22, 190, "Ruffian"},
         {23, 191, "Ruffian"},
         {21, 191, "Ruffian"},
         {24, 192, "Woodsman"},
         {17, 190, "Woodsman"},
         {20, 189, "Ruffian"},
         {21, 185, "Thug"},
         {20, 192, "Thief"},
         {20, 191, "Thief"},
         {22, 197, "Poacher"},
         {22, 189, "Trapper"},
         {20, 183, "Thug"},
         {18, 185, "Thug"},
         {27, 195, "Thug"},
         {28, 193, "Thug"},
         {32, 193, "Footpad"},
         {16, 197, "Footpad"},
         {15, 194, "Thug"},
         {12, 191, "Poacher"},
         {27, 175, "Footpad"},
         {24, 172, "Footpad"},
         {10, 187, "Trapper"},
         {23, 181, "Ruffian"},
         {25, 179, "Ruffian"},
         {36, 185, "Poacher"},
         -- West forest spawns
         {51, 199, "Poacher"},
         {48, 192, "Poacher"},
         {54, 195, "Spearman"},
         {57, 197, "Bowman"},
         {63, 196, "Thug"},
         {61, 195, "Sergeant"},
         {62, 193, "Bowman"},
         {61, 192, "Thug"},
         {61, 190, "Spearman"},
         {63, 189, "Thug"},
         {54, 189, "Footpad"},
         {51, 188, "Footpad"},
         {62, 185, "Spearman"},
         {57, 185, "Bowman"},
         {48, 185, "Poacher"},
         {50, 184, "Spearman"},
         {51, 183, "Bowman"},
         {54, 180, "Spearman"},
         {13, 165, "Bowman"},
         {15, 166, "Spearman"},
         {22, 165, "Bowman"},
         {30, 169, "Bowman"},
         {32, 170, "Spearman"},
         {33, 169, "Cavalryman"},
         {35, 172, "Bowman"},
         {37, 171, "Spearman"},
         {27, 163, "Spearman"},
         {29, 164, "Bowman"},
         {31, 163, "Spearman"},
         {44, 172, "Cavalryman"},
         {51, 174, "Heavy Infantryman"},
         {48, 176, "Horseman"},
         {55, 175, "Lieutenant"},
         {55, 176, "Fencer"},
         {56, 175, "Horseman"},
         {56, 176, "Bowman"},
         {56, 177, "Spearman"},
         {53, 172, "Thug"},
         {51, 172, "Spearman"},
         {49, 171, "Bowman"},
         {49, 168, "Spearman"},
         {51, 167, "Thug"},
         {43, 168, "Bowman"},
         {44, 166, "Spearman"},
         {43, 164, "Bowman"},
         {41, 163, "Spearman"},
         {38, 162, "Bowman"},
         {41, 162, "Cavalryman"},
         {45, 159, "Cavalryman"},
         {49, 167, "Horseman"},
         {35, 162, "Horseman"},
         {36, 161, "Spearman"},
         {35, 161, "Bowman"},
         {34, 159, "Spearman"},
         {37, 158, "Heavy Infantryman"},
         {32, 158, "Bowman"},
         {30, 154, "Poacher"},
         {47, 165, "Shock Trooper"},
         {47, 164, "Fencer"},
         {46, 162, "Red Mage"},
         {46, 161, "White Mage"},
         {45, 162, "Knight"},
         {47, 162, "Swordsman"},
         {48, 163, "General"},
         {48, 164, "Longbowman"},
         {49, 164, "Pikeman"},
         {48, 160, "Heavy Infantryman"},
         {48, 158, "Spearman"},
         {47, 157, "Bowman"},
         {45, 157, "Spearman"},
         {42, 156, "Bowman"},
         {42, 154, "Spearman"},
         {38, 155, "Cavalryman"},
         {44, 153, "Cavalryman"},
         {26, 150, "Cavalryman"},
         {31, 150, "Horseman"},
         {29, 145, "Horseman"},
         {3, 146, "Spearman"},
         {5, 148, "Spearman"},
         {5, 149, "Bowman"},
         {17, 152, "Poacher"},
         {18, 142, "Spearman"},
         {26, 147, "Bowman"},
         {29, 150, "Spearman"},
         {29, 144, "Poacher"},
         {37, 147, "Footpad"},
         {45, 148, "Spearman"},
         {49, 148, "Heavy Infantryman"},
         {51, 152, "Heavy Infantryman"},
         {51, 153, "Trapper"},
         {54, 148, "Spearman"},
         {54, 147, "Knight"},
         {55, 148, "Trapper"},
         {53, 154, "Poacher"},
         {51, 159, "Poacher"},
         {57, 142, "Spearman"},
         {64, 141, "Pikeman"},
         {60, 142, "Dragoon"},
         {53, 137, "Spearman"},
         {51, 136, "Poacher"},
         {29, 137, "Lieutenant"},
         {30, 136, "White Mage"},
         {29, 136, "Knight"},
         {26, 137, "Fencer"},
         {25, 138, "Spearman"},
         {26, 138, "Bowman"},
         {25, 135, "Bowman"},
         {28, 133, "Spearman"},
         {34, 133, "Cavalryman"},
         {46, 134, "Cavalryman"},
         {32, 124, "Cavalryman"},
         {36, 95, "Spearman"},
         {35, 96, "Bowman"},
         {34, 102, "Poacher"},
         {32, 109, "Poacher"},
         {34, 110, "Spearman"},
         {34, 116, "Spearman"},
         {31, 122, "Footpad"},
         {39, 128, "Swordsman"},
         {40, 126, "Spearman"},
         {42, 126, "Pikeman"},
         {43, 129, "Longbowman"},
         -- Outer city fortifications
         {65, 135, "Thug"},
         {65, 133, "Poacher"},
         {66, 131, "Spearman"},
         {56, 129, "Spearman"},
         {54, 128, "Bowman"},
         {52, 124, "Sergeant"},
         {49, 123, "Spearman"},
         {49, 122, "Bowman"},
         {50, 122, "Fencer"},
         {51, 122, "Mage"},
         {52, 121, "Spearman"},
         {57, 122, "Heavy Infantryman"},
         {61, 127, "Cavalryman"},
         {67, 122, "Cavalryman"},
         {77, 124, "Poacher"},
         {72, 121, "Footpad"},
         {67, 119, "Spearman"},
         {67, 118, "Bowman"},
         {66, 117, "Swordsman"},
         {64, 118, "Pikeman"},
         {62, 119, "Shock Trooper"},
         {59, 118, "Shock Trooper"},
         {58, 117, "Longbowman"},
         {54, 116, "White Mage"},
         {56, 117, "White Mage"},
         {55, 117, "Arch Mage"},
         {55, 116, "Red Mage"},
         {54, 115, "Mage"},
         {53, 115, "Pikeman"},
         {53, 113, "Swordsman"},
         {53, 112, "Longbowman"},
         {52, 118, "Mage of Light"},
         {52, 119, "Red Mage"},
         {51, 119, "Mage"},
         {51, 118, "General"},
         {50, 118, "Trapper"},
         {49, 119, "Swordsman"},
         {49, 118, "Pikeman"},
         {50, 117, "Duelist"},
         {51, 117, "Rogue"},
         {52, 116, "Knight"},
         {52, 117, "Knight"},
         {53, 118, "Dragoon"},
         {53, 119, "Knight"},
         {54, 118, "Horseman"},
         {55, 119, "Horseman"},
         {54, 119, "Fencer"},
         {53, 120, "Swordsman"},
         {55, 120, "Pikeman"},
         {57, 119, "Shock Trooper"},
         {54, 120, "Cavalryman"},
         {48, 113, "Poacher"},
         {50, 113, "Footpad"},
         {45, 112, "Thug"},
         {49, 108, "Spearman"},
         {54, 108, "Bowman"},
         {59, 111, "Heavy Infantryman"},
         {56, 116, "Horseman"},
         {64, 113, "Cavalryman"},
         {58, 105, "Cavalryman"},
         {57, 107, "Spearman"},
         {55, 106, "Bowman"},
         {52, 104, "Spearman"},
         {90, 129, "Spearman"},
         {88, 129, "Bowman"},
         {89, 131, "Heavy Infantryman"},
         {93, 131, "Cavalryman"},
         {97, 133, "Spearman"},
         {86, 128, "Footpad"},
         {88, 126, "Spearman"},
         {90, 125, "Mage"},
         {93, 121, "White Mage"},
         {105, 129, "Swordsman"},
         {103, 128, "Spearman"},
         {105, 126, "Spearman"},
         {104, 125, "Bowman"},
         {102, 127, "Lieutenant"},
         {103, 126, "Horseman"},
         {95, 127, "Poacher"},
         {103, 123, "Poacher"},
         {106, 118, "Spearman"},
         {103, 127, "Heavy Infantryman"},
         {100, 122, "Cavalryman"},
         {95, 123, "Knight"},
         {96, 121, "Horseman"},
         {99, 119, "Poacher"},
         {102, 120, "Thug"},
         {92, 128, "Thug"},
         {100, 120, "Footpad"},
         {94, 119, "Thief"},
         {95, 119, "Thief"},
         {90, 122, "Fencer"},
         {91, 123, "Fencer"},
         {91, 124, "General"},
         {92, 124, "Pikeman"},
         {93, 125, "Horseman"},
         {96, 124, "Spearman"},
         {98, 122, "Spearman"},
         {98, 121, "Bowman"},
         {97, 122, "Bowman"},
         {95, 124, "Heavy Infantryman"},
         {91, 120, "Shock Trooper"},
         {91, 118, "Trapper"},
         {90, 121, "Spearman"},
         {88, 120, "Thug"},
         {89, 121, "Mage"},
         {87, 118, "Shock Trooper"},
         {86, 118, "Pikeman"},
         {87, 117, "Swordsman"},
         {84, 115, "Longbowman"},
         {82, 114, "Pikeman"},
         {84, 112, "Spearman"},
         {84, 113, "Horseman"},
         {83, 113, "Horseman"},
         {79, 109, "Cavalryman"},
         {87, 112, "Thug"},
         {87, 108, "Longbowman"},
         {84, 106, "Royal Guard"},
         {74, 101, "Iron Mauler"},
         {77, 113, "Spearman"},
         {76, 112, "Bowman"},
         {75, 111, "Heavy Infantryman"},
         {77, 111, "Spearman"},
         {73, 107, "Master at Arms"},
         {72, 107, "Duelist"},
         {72, 106, "Duelist"},
         {73, 105, "Fencer"},
         {73, 106, "Fencer"},
         {74, 106, "Fencer"},
         {70, 101, "Shock Trooper"},
         {70, 99, "Great Mage"},
         {69, 99, "Arch Mage"},
         {69, 100, "Silver Mage"},
         {68, 98, "Red Mage"},
         {68, 99, "Red Mage"},
         {67, 98, "Mage"},
         {62, 101, "Paladin"},
         {64, 102, "Mage of Light"},
         {63, 102, "White Mage"},
         {64, 101, "White Mage"},
         {63, 101, "White Mage"},
         {65, 101, "Mage"},
         {66, 99, "Mage"},
         {65, 97, "Mage"},
         {62, 97, "Mage"},
         {59, 97, "Cavalryman"},
         {47, 101, "Spearman"},
         {47, 100, "Bowman"},
         {49, 98, "Poacher"},
         {51, 99, "Spearman"},
         {51, 100, "Bowman"},
         {52, 96, "Footpad"},
         {53, 95, "Spearman"},
         {53, 94, "Bowman"},
         {54, 92, "Spearman"},
         {56, 91, "Poacher"},
         {50, 99, "Horseman"},
         {52, 99, "Lieutenant"},
         {60, 92, "Shock Trooper"},
         {62, 92, "Heavy Infantryman"},
         {57, 90, "Bowman"},
         {57, 89, "Spearman"},
         {58, 86, "Spearman"},
         {60, 84, "Bowman"},
         {63, 83, "Spearman"},
         {64, 82, "Bowman"},
         {66, 82, "Spearman"},
         {68, 82, "Bowman"},
         {70, 81, "Spearman"},
         {63, 87, "Swordsman"},
         {63, 86, "Javelineer"},
         {64, 86, "Pikeman"},
         {64, 87, "Longbowman"},
         {69, 87, "White Mage"},
         {70, 86, "Swordsman"},
         {69, 90, "Shock Trooper"},
         {72, 88, "Shock Trooper"},
         {71, 88, "Knight"},
         {70, 89, "Lancer"},
         {74, 87, "Longbowman"},
         {67, 85, "Dragoon"},
         {73, 81, "Shock Trooper"},
         {75, 81, "Heavy Infantryman"},
         {75, 80, "Poacher"},
         {77, 81, "Spearman"},
         {79, 80, "Bowman"},
         {81, 81, "Spearman"},
         {81, 79, "Poacher"},
         {80, 82, "Swordsman"},
         {77, 86, "Cavalryman"},
         {84, 82, "Pikeman"},
         {84, 84, "Longbowman"},
         {83, 85, "White Mage"},
         {83, 84, "Fencer"},
         {82, 84, "Shock Trooper"},
         {82, 85, "Longbowman"},
         {83, 86, "Swordsman"},
         {80, 83, "Thief"},
         {73, 84, "Thief"},
         {72, 85, "Thief"},
         {76, 83, "Rogue"},
         {65, 88, "Rogue"},
         {74, 86, "Fencer"},
         {78, 84, "Fencer"},
         {65, 89, "Fencer"},
         {70, 87, "Duelist"},
         {66, 84, "Fencer"},
         -- Inner city fortifications
         {77, 92, "General"},
         {90, 95, "Grand Marshal"},
         {91, 96, "General"},
         {85, 94, "Royal Warrior"},
         {86, 94, "Grand Knight"},
         {85, 95, "Royal Guard"},
         {84, 94, "Royal Guard"},
         {86, 93, "Royal Guard"},
         {84, 93, "Iron Mauler"},
         {85, 93, "Iron Mauler"},
         {87, 94, "Master Bowman"},
         {86, 95, "Cavalier"},
         {87, 95, "Mage of Light"},
         {88, 96, "Master at Arms"},
         {87, 98, "Great Mage"},
         {85, 96, "Halberdier"},
         {85, 98, "Master Bowman"},
         {88, 99, "Royal Guard"},
         {90, 98, "Iron Mauler"},
         {91, 95, "Lieutenant"},
         {92, 95, "Lieutenant"},
         {93, 95, "Sergeant"},
         {91, 97, "Arch Mage"},
         {87, 92, "White Mage"},
         {83, 92, "Red Mage"},
         {89, 96, "Knight"},
         {90, 96, "Knight"},
         {89, 97, "Knight"},
         {90, 97, "Knight"},
         {86, 97, "Paladin"},
         {88, 98, "Dragoon"},
         {91, 98, "Longbowman"},
         {92, 97, "Pikeman"},
         {92, 96, "Swordsman"},
         {90, 93, "Duelist"},
         {92, 93, "Iron Mauler"},
         {94, 94, "Royal Guard"},
         {88, 91, "Master Bowman"},
         {86, 90, "Halberdier"},
         {90, 92, "Duelist"},
         {89, 92, "Red Mage"},
         {91, 93, "Royal Guard"},
         {85, 90, "Shock Trooper"},
         {96, 95, "Ranger"},
         {98, 96, "Trapper"},
         {100, 97, "Halberdier"},
         {102, 98, "Master Bowman"},
         {100, 99, "Highwayman"},
         {103, 99, "Fugitive"},
         {103, 100, "Thug"},
         {96, 97, "Fencer"},
         {100, 102, "Thug"},
         {100, 100, "Footpad"},
         {97, 103, "Thug"},
         {98, 99, "Thief"},
         {95, 99, "Rogue"},
         {92, 99, "Duelist"},
         {94, 100, "Assassin"},
         {96, 101, "Rogue"},
         {97, 100, "Pikeman"},
         {93, 102, "Pikeman"},
         {90, 106, "Trapper"},
         {92, 105, "Swordsman"},
         {87, 105, "Iron Mauler"},
         {89, 106, "Halberdier"},
         {88, 104, "Lieutenant"},
         {86, 103, "Sergeant"},
         {85, 104, "Javelineer"},
         {83, 103, "Longbowman"},
         {81, 102, "Swordsman"},
         {82, 101, "Spearman"},
         {79, 101, "Royal Guard"},
         {77, 100, "Halberdier"},
         {78, 99, "Red Mage"},
         {79, 98, "Shock Trooper"},
         {80, 98, "Swordsman"},
         {89, 102, "Red Mage"},
         {91, 102, "Fencer"},
         {91, 103, "Fencer"},
         {90, 103, "Thief"},
         {86, 100, "Longbowman"},
         {75, 99, "Pikeman"},
         {73, 98, "Longbowman"},
         {75, 98, "Spearman"},
         {73, 97, "Spearman"},
         {71, 97, "Spearman"},
         {69, 96, "Heavy Infantryman"},
         {68, 94, "Bowman"},
         {69, 94, "Cavalryman"},
         {69, 95, "Horseman"},
         {70, 94, "Heavy Infantryman"},
         {69, 93, "Spearman"},
         {72, 91, "Royal Guard"},
         {75, 90, "Halberdier"},
         {75, 93, "Iron Mauler"},
         {76, 89, "Master Bowman"},
         {76, 91, "White Mage"},
         {76, 93, "Duelist"},
         {78, 92, "Fencer"},
         {78, 94, "Fencer"},
         {80, 93, "Fencer"},
         {82, 94, "Duelist"},
         {78, 88, "Spearman"},
         {80, 87, "Bowman"},
         {82, 88, "Spearman"},
         {78, 89, "Swordsman"},
         {80, 90, "Spearman"},
         {82, 89, "Heavy Infantryman"},
         {73, 95, "Heavy Infantryman"},
         {75, 96, "Shock Trooper"},
         -- Embassies in city
         {79, 96, "Ghazi"},
         {77, 97, "Dwarvish Runesmith"},
         {82, 97, "Elvish Sylph"},
         -- North forest spawns
      }
      local mob_coords = {
         {138, 6, "Goblin Spearman"},
         {142, 7, "Goblin Spearman"},
         {139, 9, "Goblin Spearman"},
         {135, 9, "Goblin Spearman"},
         {140, 12, "Goblin Spearman"},
         {140, 13, "Goblin Spearman"},
         {146, 14, "Goblin Rouser"},
         {145, 14, "Goblin Spearman"},
         {145, 15, "Goblin Spearman"},
         {146, 15, "Goblin Spearman"},
         {147, 17, "Goblin Impaler"},
         {149, 16, "Goblin Impaler"},
         {124, 10, "Goblin Impaler"},
         {123, 8, "Goblin Spearman"},
         {120, 6, "Goblin Rouser"},
         {121, 6, "Goblin Spearman"},
         {124, 3, "Wolf Rider"},
         {123, 4, "Wolf Rider"},
         {117, 1, "Goblin Impaler"},
         {119, 2, "Goblin Spearman"},
         {116, 4, "Goblin Spearman"},
         {112, 2, "Goblin Spearman"},
         {109, 2, "Goblin Spearman"},
         {110, 4, "Goblin Rouser"},
         {109, 4, "Goblin Spearman"},
         {109, 5, "Goblin Spearman"},
         {110, 5, "Goblin Spearman"},
         {111, 5, "Goblin Spearman"},
         {111, 4, "Goblin Spearman"},
         {110, 3, "Goblin Spearman"},
         {105, 4, "Wolf Rider"},
         {103, 3, "Goblin Spearman"},
         {100, 3, "Goblin Impaler"},
         {122, 3, "Goblin Spearman"},
         {128, 2, "Goblin Spearman"},
         {131, 8, "Goblin Rouser"},
         {132, 8, "Goblin Impaler"},
         {130, 7, "Goblin Spearman"},
         {131, 7, "Goblin Spearman"},
         {130, 8, "Goblin Spearman"},
         {131, 4, "Goblin Spearman"},
         {133, 4, "Goblin Spearman"},
         {135, 2, "Goblin Spearman"},
         {144, 3, "Goblin Spearman"},
         {144, 4, "Goblin Spearman"},
         {143, 4, "Goblin Rouser"},
         {142, 3, "Goblin Spearman"},
         {146, 7, "Goblin Spearman"},
         {144, 9, "Goblin Spearman"},
         {144, 11, "Wolf Rider"},
         {147, 12, "Wolf Rider"},
         {147, 13, "Wolf Rider"},
         {148, 11, "Goblin Rouser"},
         {148, 12, "Goblin Spearman"},
         {148, 10, "Goblin Spearman"},
         {149, 11, "Goblin Spearman"},
      }
      for i, coord in ipairs(peasant_coords) do
         spawn_npc(coord, "Peasant")
      end
      for i, coord in ipairs(woodsman_coords) do
         spawn_npc(coord, "Woodsman")
      end
      for i, coord in ipairs(ruffian_coords) do
         spawn_npc(coord, "Ruffian")
      end
      for i, coord in ipairs(guard_coords) do
         spawn_unit.spawn_unit(coord[1], coord[2], coord[3], 6)
      end
      for i, coord in ipairs(mob_coords) do
         spawn_unit.spawn_unit(coord[1], coord[2], coord[3], 1)
      end
      -- Disguise the elvish diplomat
      change_unit.transform_keeping_stats(82, 97, wesnoth.get_unit(82, 97), "Elvish Lady")
      fire.label(138, 5, "Intercontinental Teleporter")
      fire.label(138, 6, "(Goblin Occupied)")
      fire.label(19, 89, "Ruins of Angcyn")
      fire.label(54, 117, "Fortress Aethylcyn")
      fire.label(65, 98, "The Academy")
      fire.label(95, 102, "Old Labaenry")
      fire.label(88, 95, "The Citadel")
      fire.label(80, 96, "Diplomatic Quarter")
      fire.label(77, 95, "Market District")
      fire.label(71, 87, "New Labaenry")
      fire.label(95, 122, "Colony of South Labaenry")
      fire.label(102, 68, "Town of Seoraedd")
      fire.label(43, 161, "Town of Blynaerth")
      fire.label(60, 192, "Town of Luddoc")
      fire.label(20, 193, "Fort Owidd")
      fire.label(123, 67, "Fort Gurran")
      fire.label(169, 57, "East Rheon")
      fire.label(154, 52, "Wesrheon")
      fire.label(208, 36, "Fort Garn")
      fire.label(44, 29, "Town of Sellyn")
      fire.label(137, 91, "Elabril")
      fire.label(143, 81, "North Elabril")
      fire.label(191, 53, "Delarion")
      fire.label(248, 171, "Republic of Blinadoc")
      fire.label(49, 27, "Sellyn Teleporter")
      fire.label(92, 89, "Labaenry Teleporter")
      fire.label(62, 98, "Academy Teleporter")
      fire.label(98, 119, "South Labaenry Teleporter")
      fire.label(47, 158, "Blynaerth Teleporter")
      fire.label(172, 53, "Rheon Teleporter")
      fire.label(204, 31, "Garn Teleporter")
      fire.label(267, 25, "Teleporter")
      fire.label(210, 55, "Delarion Teleporter")
      fire.label(202, 72, "Teleporter")
      fire.label(147, 86, "Elabril Teleporter")
      fire.label(202, 72, "Teleporter")
      fire.label(141, 122, "Teleporter")
      fire.label(238, 64, "Teleporter")
      fire.label(300, 79, "Teleporter")
      fire.label(310, 144, "Teleporter")
      fire.label(214, 116, "Teleporter")
      fire.label(246, 159, "Blinadoc Teleporter")
      fire.label(214, 171, "Teleporter")
   -- else
   --    debugOut(wesnoth.get_variable("aeth_scenario_name"))
   end
end
>>
#enddef
